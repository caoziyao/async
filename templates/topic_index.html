{% extends "base.html" %}


	{% block title %}{% endblock %}

	{% block css %}
		<link type="text/css" rel="stylesheet" href="{{ url_for('static', filename='css/topic_index.css') }}">
	{% endblock %}
    
	{% block script %}
		<script>
			$(document).ready(function(){
				var log = function(){
					console.log(arguments)
				}
				// log('work')
				// http://127.0.0.1:3000/topic/?node_id=1
				var par = window.location.search //?node_id=1
				var node_id = par.split('=')[1]	- 1
				log(node_id)
				var current = $('.inner a:eq('+ node_id +')')
				current.attr("class", 'tap-current')
			})
		</script>
	
	{% endblock %}


	{% block sidebar %}
		{% if user %}
			<!--已经登录-->
			<div class="box">
				<div class="cell">
					<img class="avatar"  src="{{ user.img_url }}" alt="我的头像">
					<span class="bigger">
						<a href="#">{{ user.username }} </a>
					</span>

					<div class="cell-nav">
						<ul>
							<li>
								<a href="#">
									<span class="li-bigger">0</span>
									<div class="sep3"></div>
									<span>节点收藏</span>
								</a>
							</li>
							<li>
								<a href="#">
									<span class="li-bigger">0</span>
									<div class="sep3"></div>
									<span>主题收藏</span>
								</a>
							</li>
							<li>
								<a href="#">
									<span class="li-bigger">0</span>
									<div class="sep3"></div>
									<span>特别关注</span>
								</a>
							</li>
						</ul>
					</div>
				</div>

			</div>

			
			<div class="new-item">
				<img width="32" src="{{ url_for('static', filename='img/flat_compose.png') }}">
				<a href="{{ url_for('topic.topic_new') }}">创作新主题</a>
			</div>
		{% else %}
			<!--没登录-->
			<div class="box">
				<div class="cell">
					<h4>v2ex = way to explore</h3>
					<p class="fade">V2EX 是一个关于分享和探索的地方</p>		
				</div>

				<div class="cell">
					<div class="center button">
						<a href="{{ url_for('user.user') }}">现在注册/登录</a>
					</div>	
				</div>

			</div>
		{% endif %}

	{% endblock %}



	{% block content %}
	<div class="index-content">
		<div class="sep20"></div>
		<div class="box">
			<div class="inner">
				<a class="tab" href="{{ url_for('topic.topic', node_id=1) }}">技术</a>
				<a class="tab" href="{{ url_for('topic.topic', node_id=2) }}">创意</a>
				<a class="tab" href="{{ url_for('topic.topic', node_id=3) }}">好玩</a>
				<a class="tab" href="{{ url_for('topic.topic', node_id=4) }}">Apple</a>
				<a class="tab" href="{{ url_for('topic.topic', node_id=5) }}">酷工作</a>
				<a class="tab" href="{{ url_for('topic.topic', node_id=6) }}">交易</a>
				<a class="tab" href="{{ url_for('topic.topic', node_id=7) }}">城市</a>
				<a class="tab" href="{{ url_for('topic.topic', node_id=8) }}">问与答</a>
				<a class="tab" href="{{ url_for('topic.topic', node_id=9) }}">最热</a>
				<a class="tab" href="{{ url_for('topic.topic', node_id=10) }}">全部</a>
				<a class="tab" href="{{ url_for('topic.topic', node_id=11) }}">R2</a>
				<a class="tab" href="{{ url_for('topic.topic', node_id=12) }}">节点</a>
				<a class="tab" href="{{ url_for('topic.topic', node_id=13) }}">关注</a>
			</div>


			{% for t in topic_list[::-1] %}
			<div class="cell-item clearfix">
				<!--因为定义的关系，不用查询也可以知道t.user.img_url-->
				<div class="item-img">
					<img class="avatar"  src="{{ t.user.img_url }}" alt="avator">
				</div>
				
				<div class="item-content">
					<div class="item_title">
						<a href="{{ url_for('detail.detail', topic_id=t.id) }}">{{t.title}}</a>
					</div>
					
					<div class="small fade">
						<div>
							{{ t.user.username }}
							<stamp>{{ t.created_time }}</stamp>
						</div>
					</div>			
				</div>

				<div class="count_livid clearfix" >
					<a href="{{ url_for('detail.detail', topic_id=t.id) }}">{{ t.comments | length() }}</a>
				</div>	
			</div>
			{% endfor %}
		</div>
	</div>
		
	{% endblock %}





